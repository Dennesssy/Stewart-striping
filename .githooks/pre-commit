#!/bin/sh
# Pre-commit hook for Stewart-striping project

echo "Running pre-commit checks..."

# Check if node_modules exists
if [ ! -d "node_modules" ]; then
  echo "‚ö†Ô∏è  node_modules not found. Skipping checks."
  exit 0
fi

# Run linting if available
if command -v npm &> /dev/null && grep -q "\"lint\"" package.json 2>/dev/null; then
  echo "üîç Running linter..."
  npm run lint --silent
  if [ $? -ne 0 ]; then
    echo "‚ùå Linting failed. Please fix errors before committing."
    exit 1
  fi
  echo "‚úÖ Linting passed"
fi

# Check for console.log statements
if git diff --cached --name-only | grep -E '\.(js|jsx|ts|tsx)$' | xargs grep -n "console\.log" 2>/dev/null; then
  echo "‚ö†Ô∏è  Warning: Found console.log statements in your changes"
  echo "Consider removing them before committing"
fi

# Check for TODO/FIXME comments
if git diff --cached --name-only | grep -E '\.(js|jsx|ts|tsx)$' | xargs grep -n -E "TODO|FIXME" 2>/dev/null; then
  echo "‚ö†Ô∏è  Found TODO/FIXME comments in your changes"
fi

echo "‚úÖ Pre-commit checks completed"
exit 0
